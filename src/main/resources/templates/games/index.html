<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
    <th:block th:replace="fragments/styles :: bootStyle"></th:block>

</head>

<body>
    <header th:replace="fragments/nav :: nav"></header>
    <main class="container-fluid">
        <div class="">
            <a class="btn btn-dark btn-sm my-3" th:href="@{/games/create}">Add a new game</a>
            <a class="btn btn-dark btn-sm my-3" th:href="@{/devs/create}">Add a new dev</a>
            <a class="btn btn-dark btn-sm my-3" th:href="@{/genres/create}">Add a new genre</a>
            <div class="filtersBy">
                <form th:action="@{/games/filters}" method="get">
                    <select class="genreSelect" name="genreId">
                        <option value=""> Select a genre </option>
                        <option th:each="g : ${genres}" th:value="${g.id}" th:text="${g.name}"
                            th:selected="${g.id == searchGenreId}">

                        </option>
                    </select>
                    <select class="devSelect" name="devId">
                        <option value=""> Select a developer </option>
                        <option th:each="d : ${devs}" th:value="${d.id}" th:text="${d.name}"
                            th:selected="${d.id == searchDevId}">

                        </option>
                    </select>
                    <button class="btn btn-dark btn-sm my-3" type="submit">Filter</button>
                </form>
            </div>

        </div>
        <div class="pagination d-flex justify-content-center">
            <a class="btn btn-sm btn-dark mx-4"
                th:href=" @{|/games?page=${currentPage == 0 ? totalPages - 1 : currentPage - 1}&size=10|}">Prev</a>

            <span class="fw-bold">Page [[${currentPage + 1}]] of [[${totalPages}]]</span>

            <a class="btn btn-sm btn-dark mx-4"
                th:href="@{|/games?page=${currentPage + 1 == totalPages ? 0 : currentPage + 1}&size=10|}">Next</a>
        </div>

        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Title</th>
                        <th scope="col">Year of publication</th>
                        <th scope="col">Price</th>
                        <th scope="col">Developer</th>
                        <th scope="col">Genre</th>
                        <th scope="col">Consoles</th>
                        <th scope="col">Image</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="game: ${games}" th:object="${game}">
                        <td><a th:href="@{'/games/' + *{id}}">[[*{title}]]</a></td>
                        <td>[[*{year}]]</td>
                        <td>[[*{getPriceWithCurrency}]]</td>
                        <td><a th:href="@{/devs/{id}(id=${game.dev.id})}">[[*{dev}]]</a></td>
                        <td><a th:href="@{/genres/{id}(id=${game.genre.id})}">[[*{genre}]]</a></td>
                        <td>[[*{consolesAsString}]]</td>
                        <td><img th:src="*{url}" alt=""></td>
                        <td><a th:href="@{/games/{id}(id=${game.id})}" class="btn btn-sm my-3 btn-dark">Show</a></td>
                        <td><a class="btn btn-dark btn-sm my-3" th:href="@{/games/edit/{id}(id=${game.id})}">Edit</a>
                        </td>
                        <form th:action="@{/games/delete/{id}(id=${game.id})}" method="post">
                            <td>
                                <button type="submit" class="btn btn-danger btn-sm my-3">Delete</button>
                            </td>
                        </form>
                    </tr>
                </tbody>
            </table>
        </div>

    </main>
</body>

</html>